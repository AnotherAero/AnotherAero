<!DOCTYPE html>
<html lang="en" dir="ltr">
  <head>
    <meta charset="utf-8">
    <title>Low Budget Wordle</title>
  </head>
  <body>
    <div class="" align="center">
      <h1>Low Budget Wordle</h1>
      <h5 id="notif">A letter only appears once in the word</h5>
      <table>
        <tr>
          <td id="1"></td>
          <td id="2"></td>
          <td id="3"></td>
          <td id="4"></td>
          <td id="5"></td>
        </tr>
        <tr>
          <td id="6"></td>
          <td id="7"></td>
          <td id="8"></td>
          <td id="9"></td>
          <td id="10"></td>
        </tr>
        <tr>
          <td id="11"></td>
          <td id="12"></td>
          <td id="13"></td>
          <td id="14"></td>
          <td id="15"></td>
        </tr>
        <tr>
          <td id="16"></td>
          <td id="17"></td>
          <td id="18"></td>
          <td id="19"></td>
          <td id="20"></td>
        </tr>
        <tr>
          <td id="21"></td>
          <td id="22"></td>
          <td id="23"></td>
          <td id="24"></td>
          <td id="25"></td>
        </tr>
        <tr>
          <td id="26"></td>
          <td id="27"></td>
          <td id="28"></td>
          <td id="29"></td>
          <td id="30"></td>
        </tr>
      </table>
      <br>
      <input id="inp" type="text" name="" value="">
      <button id="btn" type="button" name="button" onclick="getWord()">Enter</button>
    </div>


    <script type="text/javascript">
      //var id = 1;
      //document.getElementById(id).style.backgroundColor="red";
      var solution = "COAST"; //MUST BE UPPERCASE!!!!
      var validWord = true;
      var currentID = 1;
      var winCondition = 0;

      async function getWord() {
        //Word is changed to all upper case
        var input = document.getElementById("inp").value.toUpperCase();

        if (input.length != 5) { //Check if word is the right length
          notif.style.color ="red";
          notif.innerHTML = "Word does not have a length of 5";
          return;
        }
        await checkWord(input) //Check if word is valid and awaits till the check is done using await
        //checks the validWord variable and
        if (validWord) {
          notif.style.color ="white";
          notif.innerHTML = "-";
          compareWord(input);
          console.log(input);
        }else {
          notif.style.color ="red";
          notif.innerHTML = "Word does not exist";
        }
      }
      function compareWord(toCompare){
        //console.log(currentID);
        //compares the entered word with the solution
        //and colors the tiltes accordingly
        //currentID is used to determin which tile is currently used
        for (var i = 0; i < 5; i++) {
          if (toCompare.charAt(i) == solution.charAt(i)) {
              document.getElementById(currentID).style.backgroundColor = "green";
              document.getElementById(currentID).innerHTML = toCompare.charAt(i);
              winCondition++;
              currentID++;
          }else if (solution.search(toCompare.charAt(i)) != -1) {
            document.getElementById(currentID).style.backgroundColor = "orange";
            document.getElementById(currentID).innerHTML = toCompare.charAt(i);
            currentID++;
          }else {
            //document.getElementById(currentID).style.backgroundColor = "red";
            document.getElementById(currentID).innerHTML = toCompare.charAt(i);
            currentID++;
          }
        }
        //Check winning condition
        //if 5 letters in a row are correct, the winCondition var goes up to 5
        //if it isn't 5, it gets reset to 0 for the next row
        if (winCondition == 5) {
          notif.style.color ="green";
          notif.innerHTML = "You Won!";
          document.getElementById("btn").disabled = true;
        //check if the last row is reached
        }else if (currentID > 26) {
          notif.style.color ="red";
          notif.innerHTML = "You Lost!";
          document.getElementById("btn").disabled = true;
        }else{
          winCondition = 0;
        }
      }
      //function has to be async to be able to use the await keyword
      //checks if the word does exists with an API
      //changes the validWord value depending on if the current word does exist or not
      async function checkWord(word){
        var link = "https://api.dictionaryapi.dev/api/v2/entries/en/" + word;
        //https://www.youtube.com/watch?v=cuEtnrL9-H0 FETCH API EXPLAINED
        //the fetch has to be finished before the code continues
        await fetch(link)
          .then(res => {
            if (res.ok) {
              //console.log("Success");
              validWord = true;
            } else{
                //console.log("Not Sucessful");
                validWord = false;;
              }
          })
      }

    </script>
  </body>
  <style media="screen">
    td{
      text-align:center;
      table-layout:fixed;
      width:80px;
      height:80px;
      color:white;
      border:2px white solid;
      font-size:70px;
    }
    h1{
      color:white;
    }
    h5{
      color:white;
    }
    body{
      background:black;
    }
  </style>
</html>
